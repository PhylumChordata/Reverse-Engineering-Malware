# steel.zip
- After unzipping `steel.zip` we are greeted with `steel1.pdf, steel2.pdf, and steel.saz`
- Lets start with `steel1.pdf`
- Using the `file` command along with `trid` gives me confidence that we are working with a true PDF file 
- ![image](https://user-images.githubusercontent.com/75596877/182719412-f85cc543-4ad3-4470-98c7-477060a9c301.png)
- Using `VSCode` to examine this PDF we can see a bunch of capabilities followed by the rest of the PDF in raw form which isnt human readable 
- ![image](https://user-images.githubusercontent.com/75596877/182719690-592e193f-2091-42d6-b858-ae2deb659e60.png)
- Using a tool like `pdfid.py` can give us a much prettier output of all the PDFs capabilities 
- ![image](https://user-images.githubusercontent.com/75596877/182719778-2f3f6b28-ca0b-4228-a7bd-00f89e9b99fc.png)
- When we want a more detailed look at the files capabilities, I recommend using `pdf-parser.py` (use `-a` to see just statistics)
- ![image](https://user-images.githubusercontent.com/75596877/182720007-632f07ae-e888-4fb5-8494-85f53ed2aa17.png)
- Right off the bat we see alot of `/URI` capabilities being utilized, 13 to be exact
- When we use `pdf-parser.py` with the `-s` switch we can locate objects with a specific keyword (`/URI`) in this case 
- ![image](https://user-images.githubusercontent.com/75596877/182720186-32f0f84b-99a0-47da-8b0f-e79370b23f27.png)
- Utilizing this method we can limit our output with the `more` command and get a good look at where it is trying to reach out to.
- If we wanted to aggregate all the `/URI` callouts in one go we can utilize the `-k` switch 
- ![image](https://user-images.githubusercontent.com/75596877/182720342-4701ba3e-f184-4037-9405-ebd67f76a236.png)
- There are clearly alot of suspicious URLs that a victim could click on (advertently or inadvertently) and then that link could pull down a second stage i.e. implant of some sorts
- Circling back however, we saw a `/XObject` in the PDFs capabilities from before, which is an image embedded in the PDF
- To view a specific object number use the `-o` parameter 
- ![image](https://user-images.githubusercontent.com/75596877/182720674-17bebad6-68f6-4cb4-a9f4-c89b79854ad1.png)
- Notice with this output, we can see the width and height of our image in question
- Lets extract the image for more context 
- ![image](https://user-images.githubusercontent.com/75596877/182720808-d15498f8-f0b5-4c4f-b9d2-3023ff42f839.png)
- It is clear to see how this could trick an unwitting user into clicking on the reCAPTCHA prompt 
- However this image online wont reach out to anywhere looking for an additional payload, lets take a look at the objects that reference object 6 (this picture)
- ![image](https://user-images.githubusercontent.com/75596877/182721033-a44e87b1-2ae5-4412-aa29-6da206f17bd7.png)
- Based on the top of this command output we can see `obj 13` does in fact reference `obj 6`
- Continue to follow the trail and lets see what references `obj 13`
- ![image](https://user-images.githubusercontent.com/75596877/182721191-c717f364-c6bb-45cd-855a-179bae6a44b0.png)
- From this output, we can see a call to `/Annots` at `obj 14`
- This is an annotation feature of PDFs that allow for things like pop up message capabilities 
- Lets examine this object and see where it leads 
- ![image](https://user-images.githubusercontent.com/75596877/182722319-d0844fed-77c7-4d67-8992-441fce7f1778.png)
- We can see that nothing is contained in `obj 14` outside of it referencing `obj 10` which has our suspicious URI embedded in it.
- Thus if our victim clicked on our image that we extracted from before, it would call out to this URL and take unknown further actions.
- When examining the PDF by opening it, it is a two page document with the image on the first page and a large blob of text on the second, which is in a very small font.  Furthermore, the rest of the links are nested at the bottom, also in a small font.  This can lead us to the conclusion that the blob of text is designed to confuse anti-spam engines and allow the phishing message to get through.  Additionally the links being shoved the bottom along with the text leads one to believe that they were simply to throw off any analysis efforts.

