## brbbot.exe
- Specimen was first discovered in `%AppData%` --> run it from there.
- Create a shortcut on the desktop, and allow it to run with Administrator Privs

## Static Properties Analysis
- PEStudio
````
md5,1C7243C8F3586B799A5F9A2E4200AA92
sha1,4DB5A8E237937B6D7B435A8506B8584121A7E9E3
sha256,F47060D0F7DE5EE651878EB18DD2D24B5003BDB03EF4F49879F448F05034A21E
file-size,75776 (bytes)
file-type,executable
cpu,64-bit
compiler-stamp,0x54ED67C2 (Wed Feb 25 01:12:18 2015)
````
- Sections 
- `.text, .rdata, .data, .pdata, .rsrc, .reloc`
- `.text` section entrypoint `entry-point,0x00003F94`
- Sample does not appear to be packed 
- `.text` section is executable as expected

- Libraries Used
````
ws2_32.dll, wininet.dll, user32.dll, kernel32.dll, advapi32.dll 
````
- Interesting Imports (115 total)
````
RegSetValueExA
RegOpenKeyExA
RegDeleteValueA
RegFlushKey
RegCloseKey
GetComputerNameA
GetSystemWow64DirectoryA
IsDebuggerPresent
HttpSendRequestA
InternetReadFile
InternetConnectA
InternetOpenA
HttpOpenRequestA
InternetSetOptionA
CreateFileW
CreateFileA
WriteFile
MoveFileExA
CopyFileA
DeleteFileA
CreateProcessA
GetCurrentProcess
ExitProcess
CryptEncrypt
CryptCreateHash
CryptDestroyKey
CryptDecrypt
CryptDestroyHash
CryptHashData
````
- No exports
- No TLS Callback

- Resources
- Sample appears to write something to disk --> explore later 
````
CONFIG,101,0x00012270,unknown,73,0.10 %,5.971,English-US,B8 9C C3 AA DF 98 67 11 66 AB FE 23 79 07 6E 17 ,.. .. .. .. .. .. g .. f .. .. # y .. n .. 
````
- Interesting Strings 
````
exec
Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0)
Software\Microsoft\Windows\CurrentVersion\Run
%s?i=%s&c=%s&p=%s
brbconfig.tmp
CONFIG
YnJiYm90
file
conf
exit
sleep
encode
brbbot
HTTP/1.1
Connection: close\r\n
````
- String Notes
- User Agent present
- Name of file written to disk? `brbconfig.tmp` --> assume `%appdata%`
- `file, conf, exit, sleep, encode` --> C2 commands
- Clearly beacons out from API calls seen in strings and User Agent 
- Run key for persistance 
- Could also use `pestr brbbot.exe | more` || `strings -a --encoding=1` on Remnux to get ascii strings and unicode strings  

### IOCS for detection 
- File system: `brbconfig.tmp` 
- Network: `%s?i=%s&c=%s&p=%s`
- Persistance: `Software\Microsoft\Windows\CurrentVersion\Run`
- Communication: `HTTP/1.1`, `Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0)`

### PEFrame 
````
--------------------------------------------------------------------------------
Yara Plugins
--------------------------------------------------------------------------------
Advapi Hash API
IsPE64
IsWindowsGUI
HasRichSignature
--------------------------------------------------------------------------------
Behavior
--------------------------------------------------------------------------------
anti dbg
Xor
network http
screenshot
win registry
win files operation
--------------------------------------------------------------------------------
Possibile Breakpoint
--------------------------------------------------------------------------------
--snip--
CryptEncrypt
--snip--
````
### Detect It Easy
````
compiler: Microsoft Visual C/C++(2010)[-]
linker: Microsoft Linker(10.0)[GUI64]
````
## Behavioral Analysis 
- Setup: `wireshark, fakedns, accept-all-ips start`
- Regshot --> first shot 
- Procmon --> clear capture 
- Run sample, 60 seconds, terminate with Process Hacker, Terminate procmon --> Save in CSV .log file on desktop for ProcDOT import, regshot second shot.
- Examine wireshark packers, fakedns requests
### Regshot
````
----------------------------------
Values added: 330
----------------------------------
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\brbbot: "C:\Users\REM\AppData\Roaming\brbbot.exe"
HKU\S-1-5-21-1866265027-1870850910-1579135973-1000\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Store\C:\Users\REM\AppData\Roaming\brbbot.exe:  53 41 43 50 01 00 00 00 00 00 00 00 07 00 00 00 28 00 00 00 00 28 01 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 0A 73 20 00 00 DB 80 FD AC 28 39 D3 01 00 00 00 00 00 00 00 00 02 00 00 00 28 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 72 A6 00 00 00 00 00 00 01 00 00 00 01 00 00 00
----------------------------------
Files added: 4
----------------------------------
C:\Users\REM\AppData\Roaming\brbconfig.tmp
C:\Windows\Prefetch\BRBBOT.EXE-F9A274A7.pf
````
## ProcDOT
![Procdot](https://user-images.githubusercontent.com/75596877/168664367-2569206e-9567-4a7a-a351-d90b411493b6.png)
--snip--
- Nothing new discovered












