# vdaudio.dll
## Static Properties Analysis 
- Hashes 
````
md5,B0F2328750D22B52025015E9ADA820A2
sha1,46B0FC8F46A9BDA8EE1A85E0002EC1A9E31DB223
sha256,1E9F21F514EE4793CFAE7BAA21549BE0D9B432C59513D2EFED860C2B1501DA39
````
- Basic Information 
````
file-size,13312 (bytes)
entropy,6.087
file-type,dynamic-link-library
cpu,32-bit
subsystem,GUI
compiler-stamp,0x56717CA3 (Wed Dec 16 10:00:51 2015)
````
- VT Link: https://www.virustotal.com/gui/file/1e9f21f514ee4793cfae7baa21549be0d9b432c59513d2efed860c2b1501da39
- Three Level 1 indicators 
````
The file references string(s),type: blacklist, count: 4,1
The file imports symbol(s),type: blacklist, count: 7,1
The count of imports is suspicious,count: 28,1
````
- Five Libraries Used 
````
user32.dll
kernel32.dll
gdi32.dll
ws2_32.dll
ntdll.dll
````
- Imports (28) --> All shown here 
````
ReplyMessage
RegisterClassExA
CallWindowProcW
NtPrivilegeCheck
21 (setsockopt)
23 (socket)
16 (recv)
3 (closesocket)
RtlGetProcessHeaps
DeleteFileA
NtReadFile
NtQueryInformationFile
ExitProcess
LoadLibraryExA
GetModuleHandleW
GetLastError
PtInRect
LoadMenuA
DestroyCursor
lstrcpyA
FatalExit
SetWorldTransform
SetWindowExtEx
SetTextColor
PolyBezierTo
SetColorSpace
TextOutA
NtAlertThread
````
- Exports (3)
````
gewayX
gewayZ
vdaudio
````
- Interesting Strings (119)
````
NtPrivilegeCheck
NtReadFile
NtQueryInformationFile
DestroyCursor
PolyBezierTo
CallWindowProc
DeleteFile
LoadLibraryEx
GetModuleHandle
advapi32
ws2_32
LoadMenu
TextOut
gewayX
gewayZ
vdaudio
west/1.0 200 OK\r\n\r\n
<b>l</b> 
cm.mnemonicarx.biz
cn.mnemonicarx.biz
````
-  Peframe --> looking for interesting breakpoints for later use 
````
Behavior
--------------------------------------------------------------------------------
Xor
--------------------------------------------------------------------------------
Packer
--------------------------------------------------------------------------------
Borland Delphi 40 additional
Microsoft Visual Cpp v50v60 MFC
Borland Delphi 30 additional
Borland Delphi 30 
Borland Delphi Setup Module
Borland Delphi 40
Borland Delphi v40 v50
Borland Delphi v30
Borland Delphi DLL
--------------------------------------------------------------------------------
Anti Debug
--------------------------------------------------------------------------------
GetLastError
--------------------------------------------------------------------------------
Possibile Breakpoint
--------------------------------------------------------------------------------
DeleteFileA
ExitProcess
GetModuleHandleW
LoadLibraryExA
closesocket
recv
socket
````
## Behavioral Analysis 
- `capa` 
````
WARNING:capa: This sample appears to be packed.
````
- `speakeasy` output 
- Identified Mutex used 
````
remnux@remnux:~/Desktop$ run_speakeasy.py -t vdaudio.dll
0x10002cb8: 'ntdll.NtQueryInformationFile(0x0, 0x1, 0x1000b957, 0x10, 0x0)' -> 0xc000000d
0x0: export.gewayX: Caught error: invalid_fetch
0x10002ca5: 'ntdll.NtQueryInformationFile(0x0, 0xc000000c, 0x1000b957, 0x10, 0x0)' -> 0xc000000d
0x0: export.gewayZ: Caught error: invalid_fetch
0x10002cf0: 'KERNEL32.lstrcpyA(0x1000b157, "")' -> 0x1000b157
0x10002d91: 'KERNEL32.GetModuleHandleW("kernel32")' -> 0x77000000
0x10002db5: 'KERNEL32.LoadLibraryExA("advapi32", 0x0, "")' -> 0x78000000
0x10002dda: 'KERNEL32.LoadLibraryExA("ws2_32", 0x0, "")' -> 0x78c00000
0x10002e03: 'kernel32.GetModuleHandleA("ntdll.dll")' -> 0x7c000000
0x10002bec: 'kernel32.OpenMutexA(0x100000, 0x0, "LXCV0IMGIXS0RTA1")' -> 0x0
0x10002e2c: 'kernel32.GetModuleFileNameA(0x0, "C:\\Windows\\system32\\svchost.exe", 0x3e8)' -> 0x1f
* Child process timeout reached after 60 seconds
* Timeout of 60 sec(s) reached.
* Finished emulating
````
## x32db
- Malware is self defending with API `GetLastError`
- Setting error to `0x127`
````
ERROR_PROC_NOT_FOUND

127 (0x7F)

The specified procedure could not be found.
````
- ![image](https://user-images.githubusercontent.com/75596877/174451843-b7d36fea-2de2-4ab7-884c-fbc05cc8c11e.png)
- Ensure you check all left most column in `Scylla Hide` plugin 
- ![image](https://user-images.githubusercontent.com/75596877/174451913-6528173d-7de3-41de-94eb-849f15228e45.png)
- It will appear to run to the `Entry point`
- ![image](https://user-images.githubusercontent.com/75596877/174451924-d79daeeb-0926-41c8-b65d-5dd2be24c497.png)
- 
## Ghidra
- Identification of C2 Domains 
- Search for strings 
- ![image](https://user-images.githubusercontent.com/75596877/174452260-6a4fb344-dd66-419d-bd79-e2f3170cb6bb.png)
- 
