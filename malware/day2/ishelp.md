# ishelp.dll
## Static Properties Analysis 
- `pestudio`
- Hashes
````
md5,8124E6C71C44BAD2FC3D1870C7320C61
sha1,57816A296E7C575DCEEA2C2FE5171A298E17F73A
sha256,BF0D6CC20FA7A20ED7B5D0C9283D7670F73C33D7F8B3C3261AAE04969C40CE76
imphash,C55280F808CF68542ED81ABBE900927E
````
- Basic Info 
````
file-size,78848 (bytes)
description,Loader Dynamic Link Library
file-type,dynamic-link-library
cpu,32-bit
````
- Three Level 1 Indicators 
````
The file references string(s),type: blacklist, count: 35,1
The file contains another file,signature: executable, location: .rsrc, offset: 0x00005908, size: 52736,1
The file imports symbol(s),type: blacklist, count: 16,1
````
- File as an embedded exe in it 
- Located at:
- ![image](https://user-images.githubusercontent.com/75596877/173200514-7abc5bbb-b637-423d-80cd-88171fabf38e.png)
- Interesting Imports
````
CreateMutexA
OpenProcessToken
AdjustTokenPrivileges
LookupPrivilegeValueA
RegCloseKey
RegOpenKeyExA
RegDeleteValueA
GetLocalTime
WriteProcessMemory
VirtualProtectEx
VirtualAllocEx
GetFileSize
CopyFileA
GetTempPathW
DeleteFileA
RemoveDirectoryA
CreateDirectoryA
CreateFileA
WriteFile
ReadFile
TerminateProcess
CreateProcessA
CreateRemoteThread
Module32First
Process32Next
Process32First
GetCurrentProcess
Sleep
````
- Exports 
````
1,Setting,.text:10002660,-,-,-,-,-
````
- Resources 
- Where the executable is located.  Dump this to a file 
- ![image](https://user-images.githubusercontent.com/75596877/173200585-5236e48b-9c6c-4204-9f6a-6a8ffd9eb31d.png)
- Interesting Strings 
````
POST
create snapshot failed: 0x%x.
create tid snapshot failed: 0x%x.
decrypt error!
execute cmd timeout.
Create Temp File Error:0x%08x.
Create Shell ok
Update successful
create cmd error
time
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Software\Microsoft\Windows\CurrentVersion\Run
Software\Microsoft\Windows\CurrentVersion\Internet Settings
SeDebugPrivilege
%d/%02d/%02d %02d:%02d:%02d - 
rundll32.exe "%s",Setting
h_`\^%YP%.lU
%d/%02d/%02d %02d:%02d:%02d - 
Start - response head:\r\n%s.
UploadFile exception:%s,code:0x%08x.
DownloadFile - exception:%s,code:0x%08x.
cmd.exe /c %s > %s
%d/%02d/%02d %02d:%02d:%02d - 
Removing...
IE Process is running.
_MICROSOFT_LOADER_MUTEX_
<input id="checkip" type="text" name="check_ip" value="
exception:%s.
http://
https://
ishelp
server index:%d.
ChangeServerTimeCount = %d.
index %d.
ResponseStatusCode >= 500
````
### Ghidra ishelp.dll
- Clearly a dropper
- Jump to `FUN_10001820`
- In dissassembler window can see the call to `FindResourceW` and the exeutable name:
- ![image](https://user-images.githubusercontent.com/75596877/173200867-81047acd-2344-4779-b34f-ab80d6a58e08.png)
- Looking at the outgoing references we can track the process of dropping the exe
- ![image](https://user-images.githubusercontent.com/75596877/173200912-0fb12dcf-375c-400e-b98f-f44f16988529.png)
- Examine `CreateFileA`
- Set equate on `dwDesiredAccess`: 
- ![image](https://user-images.githubusercontent.com/75596877/173200956-69d5e346-bcd3-4db2-a383-60140c7d2ed5.png)
- `0x40000000` means simultaneous read and write operations
### CreateMutexA
- @ `1000025f2`
- Can see the mutex created, exceedingly good IOC
- ![image](https://user-images.githubusercontent.com/75596877/173201039-986dfc77-97b5-4db0-b66d-b862d84a350e.png)
## ASD dropped File Analysis 
- Pestudio
- Hashes
````
md5,6278FC8C7BF14514353797B229D562E8
sha1,F7E6F03511BD0A9CCC8F5253007E4505152A7453
sha256,29D8DC863427C8E37B75EB738069C2172E79607ACC7B65DE6F8086BA36ABF051
````
- Basic Information 
````
file-size,52736 (bytes)
entropy,6.407
description,DLL Dynamic Link Library
file-type,dynamic-link-library
cpu,32-bit
````
- Three level 1 indicators 
````
The file references string(s),type: blacklist, count: 11,1
A directory is invalid,type: export-table,1
The file imports symbol(s),type: blacklist, count: 18,1
````
- Interesting Imports
- 212 imports which is a ton 
````
10 (inet_addr)
9 (htons)
23 (socket)
3 (closesocket)
4 (connect)
111 (WSAGetLastError)
19 (send)
11 (inet_ntoa)
52 (gethostbyname)
57 (gethostname)
16 (recv)
CreateFileA
GetSystemTimeAsFileTime
CreateDirectoryA
GetTempFileNameA
GetTempPathA
CreateFileW
DeleteFileA
Sleep
OutputDebugStringA
CreatePipe
````
- Interesting Strings
````
POST
Start - Status Code = %d.
decrypt error!
execute cmd timeout.
Create Temp File Error:0x%08x.
Create Shell ok
Update successful
create cmd error
time
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Software\Microsoft\Windows\CurrentVersion\Run
rundll32.exe "%s",Setting
%d/%02d/%02d %02d:%02d:%02d - 
Start - response head:\r\n%s.
UploadFile exception:%s,code:0x%08x.
DownloadFile - exception:%s,code:0x%08x.
cmd.exe /c %s > %s
Ver=%d.%d
exception:%s.
http://
https://
ishelp
server index:%d.
ChangeServerTimeCount = %d.
index %d.
DownloadFile - DowndLoad File End, Length:%d.
DownloadFile - exception:%s.
guid=%s
name=%s
delay=%d
Server1=%s
Server2=%s
Server3=%s
Proxy=%d
````
- Majority of the strings focus on the C2 activity of the dropped implant 
## ASD Ghidra























